<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Esquema Mudo - Tecnolog√≠a</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --card-bg: #ffffff;
      --card-shadow: 0 8px 25px rgba(0,0,0,0.15);
      --accent: #4a90e2;
      --accent-hover: #357abd;
      --success: #27ae60;
      --error: #e74c3c;
      --text: #2c3e50;
      --text-light: #7f8c8d;
      --border: #bdc3c7;
      --empty-slot: #f1f2f6;
      font-family: 'Montserrat', sans-serif;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--bg);
      min-height: 100vh;
      color: var(--text);
      padding: 15px;
      overflow-x: auto;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
      color: white;
    }

    .header h1 {
      font-size: 2rem;
      margin-bottom: 8px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
      font-size: 1rem;
      opacity: 0.9;
    }

    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 12px;
      box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
    }

    button:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
    }

    .game-container {
      display: grid;
      grid-template-columns: 350px 1fr;
      gap: 20px;
      max-width: 1600px;
      margin: 0 auto;
      height: calc(100vh - 200px);
    }

    .cards-section {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 15px;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 20px;
      height: fit-content;
      max-height: calc(100vh - 240px);
      overflow-y: auto;
    }

    /* Buscador */
    .search-container {
      margin-bottom: 15px;
    }

    .search-box {
      width: 100%;
      padding: 10px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.3s ease;
    }

    .search-box:focus {
      outline: none;
      border-color: var(--accent);
    }

    .cards-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      padding-right: 10px;
    }

    .card {
      perspective: 1000px;
      cursor: grab;
      height: 70px; /* Reducido de 80px */
      transition: opacity 0.3s ease;
    }

    .card.hidden {
      display: none;
    }

    .card:active {
      cursor: grabbing;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      text-align: center;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card.dragging {
      opacity: 0.7;
      transform: scale(0.95);
    }

    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      padding: 10px; /* Reducido de 12px */
      font-weight: 600;
      font-size: 10px; /* Reducido de 11px */
      line-height: 1.2;
    }

    .card-front {
      background: linear-gradient(135deg, var(--accent), #5ba3f5);
      color: white;
      box-shadow: var(--card-shadow);
    }

    .card-back {
      background: var(--card-bg);
      color: var(--accent);
      border: 2px solid var(--accent);
      transform: rotateY(180deg);
      font-size: 14px; /* Reducido de 16px */
      font-weight: 700;
    }

    .schema-section {
      background: rgba(255,255,255,0.95);
      padding: 15px; /* Reducido de 20px */
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      height: 100%;
      border-radius: 15px;
      overflow-y: auto;
      white-space: nowrap;
    }

    .schema-title {
      text-align: center;
      color: var(--accent);
      margin-bottom: 15px; /* Reducido de 20px */
      font-size: 16px; /* Reducido de 18px */
    }

    .zoom-controls {
      position: sticky;
      top: 10px;
      z-index: 100;
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 5px;
      margin-bottom: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: center;
    }

    .zoom-controls button {
      background: var(--text-light);
      padding: 4px 8px;
      font-size: 10px;
      margin: 0 2px;
    }

    .schema-container {
      display: flex;
      flex-direction: column;
      gap: 20px; /* Reducido de 30px */
      padding: 10px; /* Reducido de 20px */
      width: 100%;
      max-width: 100%;
      transform-origin: top left;
      transition: transform 0.3s ease;
    }

    .block-row {
      display: flex;
      align-items: stretch;
      min-height: 80px; /* Reducido de 100px */
    }

    .block-main {
      display: flex;
      align-items: center;
      min-width: 160px; /* Reducido de 200px */
      padding: 10px; /* Reducido de 15px */
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      border: 2px solid var(--accent);
      border-radius: 8px; /* Reducido de 10px */
      margin-right: 15px; /* Reducido de 20px */
    }

    .block-title {
      display: flex;
      align-items: center;
      gap: 10px; /* Reducido de 15px */
      font-size: 12px; /* Reducido de 14px */
      font-weight: 700;
      color: var(--accent);
    }

    .block-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px; /* Reducido de 15px */
    }

    .section-row {
      display: flex;
      align-items: stretch;
      position: relative;
    }

    .section-row::before {
      content: '';
      position: absolute;
      left: -15px; /* Reducido de -20px */
      top: 50%;
      width: 15px; /* Reducido de 20px */
      height: 2px;
      background: var(--accent);
    }

    .section-main {
      display: flex;
      align-items: center;
      min-width: 140px; /* Reducido de 180px */
      padding: 8px; /* Reducido de 12px */
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      border: 2px solid #2196f3;
      border-radius: 6px; /* Reducido de 8px */
      margin-right: 10px; /* Reducido de 15px */
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 8px; /* Reducido de 10px */
      font-size: 11px; /* Reducido de 13px */
      font-weight: 600;
      color: #1976d2;
    }

    .subsections {
      display: flex;
      flex-direction: column;
      gap: 6px; /* Reducido de 8px */
      flex: 1;
    }

    .subsection-row {
      display: flex;
      align-items: center;
      position: relative;
      padding: 6px 0; /* Reducido de 8px */
    }

    .subsection-row::before {
      content: '';
      position: absolute;
      left: -10px; /* Reducido de -15px */
      top: 50%;
      width: 10px; /* Reducido de 15px */
      height: 2px;
      background: #90a4ae;
    }

    .simple-block {
      display: flex;
      align-items: stretch;
      min-height: 50px; /* Reducido de 60px */
    }

    .simple-main {
      display: flex;
      align-items: center;
      min-width: 160px; /* Reducido de 200px */
      padding: 10px; /* Reducido de 15px */
      background: linear-gradient(135deg, #f3e5f5, #e1bee7);
      border: 2px solid #9c27b0;
      border-radius: 8px; /* Reducido de 10px */
      margin-right: 15px; /* Reducido de 20px */
    }

    .simple-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px; /* Reducido de 8px */
    }

    .simple-item {
      display: flex;
      align-items: center;
      position: relative;
      padding: 6px 0; /* Reducido de 8px */
    }

    .simple-item::before {
      content: '';
      position: absolute;
      left: -15px; /* Reducido de -20px */
      top: 50%;
      width: 15px; /* Reducido de 20px */
      height: 2px;
      background: #9c27b0;
    }

    .content-text {
      flex: 1;
      font-size: 11px; /* Reducido de 13px */
      color: var(--text);
      margin-left: 8px; /* Reducido de 10px */
    }

    .dropzone {
      align-items: center;
      justify-content: flex-start;
      padding: 3px 6px; /* Reducido de 4px 8px */
      background: var(--empty-slot);
      border: 2px dashed var(--border);
      border-radius: 6px; /* Reducido de 8px */
      min-height: 30px; /* Reducido de 40px */
      min-width: 60px; /* Reducido de 80px */
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 10px; /* Reducido de 12px */
      color: var(--text-light);
      width: 100%;
      max-width: 100%;
      flex-shrink: 0;
      word-break: break-word;
    }

    .dropzone:empty::before {
      content: "?";
      font-size: 16px; /* Reducido de 18px */
      font-weight: bold;
      color: var(--border);
    }

    .dropzone.drag-over {
      border-color: var(--accent);
      background: rgba(74, 144, 226, 0.1);
      transform: scale(1.05);
    }

    .placed-card {
      background: linear-gradient(135deg, var(--success), #2ecc71);
      color: white;
      padding: 4px 8px; /* Reducido de 6px 10px */
      border-radius: 4px; /* Reducido de 6px */
      font-size: 10px; /* Reducido de 12px */
      font-weight: 700;
      text-align: left;
      box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
      white-space: normal;
      margin: 0;
    }

    .stats {
      background: rgba(255,255,255,0.95);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 15px;
      text-align: center;
      backdrop-filter: blur(10px);
    }

    .stats h3 {
      color: var(--accent);
      margin-bottom: 8px;
      font-size: 14px;
    }

    .progress-bar {
      background: #ecf0f1;
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
      margin: 8px 0;
    }

    .progress-fill {
      background: linear-gradient(90deg, var(--success), #2ecc71);
      height: 100%;
      width: 0%;
      transition: width 0.5s ease;
    }

    @keyframes wrongDrop {
      0% { transform: scale(1); }
      25% { transform: scale(1.1) rotate(3deg); }
      75% { transform: scale(0.9) rotate(-3deg); }
      100% { transform: scale(1); }
    }

    @keyframes correctDrop {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .animate-wrong { 
      animation: wrongDrop 0.6s ease;
      border-color: var(--error) !important;
      background: rgba(231, 76, 60, 0.2) !important;
    }
    
    .animate-correct { 
      animation: correctDrop 0.5s ease;
      border-color: var(--success) !important;
      background: rgba(39, 174, 96, 0.1) !important;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(74, 144, 226, 0.7); }
      70% { box-shadow: 0 0 0 8px rgba(74, 144, 226, 0); }
      100% { box-shadow: 0 0 0 0 rgba(74, 144, 226, 0); }
    }

    .pulse { animation: pulse 1.5s infinite; }

    .simple-subsection {
      margin-left: 0px;
      margin-bottom: 10px; /* Reducido de 12px */
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px; /* Reducido de 10px */
    }

    .simple-subsection::before {
      content: '';
      position: absolute;
      left: -12px; /* Reducido de -15px */
      top: 50%;
      width: 8px; /* Reducido de 10px */
      height: 2px;
      background: var(--border);
    }

    @media (max-width: 1200px) {
      .game-container {
        grid-template-columns: 1fr;
        height: auto;
      }
      
      .cards-section {
        position: relative;
        max-height: 400px;
      }
      
      .cards-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      }
      
      .card {
        height: 60px; /* Reducido de 70px */
      }

      .schema-container {
        display: flex;
        flex-direction: column;
        gap: 20px; /* Reducido de 30px */
        width: 100%;
        flex: 1;
        box-sizing: border-box;
        padding: 8px; /* Reducido de 10px */
      }

      .block-row, .simple-block {
        flex-direction: column;
        gap: 12px; /* Reducido de 15px */
      }

      .block-main, .simple-main {
        margin-right: 0;
        margin-bottom: 8px; /* Reducido de 10px */
      }

      .section-row {
        flex-direction: column;
        gap: 8px; /* Reducido de 10px */
      }

      .section-main {
        margin-right: 0;
      }

      .subsection-row, .simple-item {
        flex-direction: column;
        align-items: stretch;
        gap: 6px; /* Reducido de 8px */
      }

      .dropzone {
        width: auto;
        min-width: auto;
      }
    }

    .hint {
      font-size: 11px;
      color: var(--text-light);
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="header">
    <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; max-width: 1600px; margin: 0 auto;">
      <div>
        <h1>üéØ Esquema Mudo - Tecnolog√≠a</h1>
        <p>Completa el esquema colocando cada tarjeta en su lugar correcto</p>
      </div>
      <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
        <button onclick="resetGame()">üîÑ</button>
        <button onclick="studyMode()">üìö</button>
        <button onclick="shuffleCards()">üé≤</button>
        <button onclick="toggleKeywordSchema()">üóùÔ∏è Esquema Clave</button>
        <div class="zoom-controls" style="background: rgba(255,255,255,0.2); backdrop-filter: blur(10px);">
          <button onclick="zoomSchema(0.6)">üîç--</button>
          <button onclick="zoomSchema(0.8)">üîç-</button>
          <button onclick="zoomSchema(1.0)">100%</button>
          <button onclick="zoomSchema(1.2)">üîç+</button>
          <button onclick="zoomSchema(1.4)">üîç++</button>
        </div>
      </div>
    </div>
  </div>

  <div class="controls" style="display: none;">
    <button onclick="resetGame()">üîÑ Restablecer</button>
    <button onclick="studyMode()">üìö Modo Estudio</button>
    <button onclick="shuffleCards()">üé≤ Mezclar</button>
    <button onclick="toggleKeywordSchema()">üóùÔ∏è Esquema Clave</button>
  </div>

  <div class="game-container">
    <div>
      <div class="stats">
        <h3>üìä Progreso</h3>
        <div>Completado: <span id="correctCount">0</span>/30</div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressBar"></div>
        </div>
        <div class="hint">Haz clic en las tarjetas para ver el c√≥digo</div>
      </div>

      <div class="cards-section">
        <h2 style="text-align: center; color: var(--accent); margin-bottom: 15px; font-size: 16px;">üÉè Tarjetas</h2>
        <div class="search-container">
          <input type="text" class="search-box" id="searchBox" placeholder="üîç Buscar tarjeta..." onkeyup="filterCards()">
        </div>
        <div class="cards-grid" id="cardsGrid"></div>
      </div>
    </div>

    <div class="schema-section">
      <div class="schema-container" id="schemaContainer">
        
        <!-- Bloque A -->
        <div class="block-row">
          <div class="block-main">
            <div class="block-title">
              <div class="dropzone" data-id="A"></div>
            </div>
          </div>
          <div class="block-content">
            <!-- Secci√≥n A1 -->
            <div class="section-row">
              <div class="section-main">
                <div class="section-title">
                  <div class="dropzone" data-id="A1"></div>
                </div>
              </div>
              <div class="subsections">
                <div class="subsection-row">
                  <div class="dropzone" data-id="A11"></div>
                </div>
                <div class="subsection-row">
                  <div class="dropzone" data-id="A12"></div>
                </div>
                <div class="subsection-row">
                  <div class="dropzone" data-id="A13"></div>
                </div>
                <div class="subsection-row">
                  <div class="dropzone" data-id="A14"></div>
                </div>
              </div>
            </div>

            <!-- Secci√≥n A2 -->
            <div class="section-row">
              <div class="section-main">
                <div class="section-title">
                  <div class="dropzone" data-id="A2"></div>
                </div>
              </div>
              <div class="subsections">
                <div class="subsection-row">
                  <div class="dropzone" data-id="A21"></div>
                </div>
                <div class="subsection-row">
                  <div class="dropzone" data-id="A22"></div>
                </div>
              </div>
            </div>

            <!-- Secci√≥n A3 -->
            <div class="section-row">
              <div class="section-main">
                <div class="section-title">
                  <div class="dropzone" data-id="A3"></div>
                </div>
              </div>
              <div class="subsections">
                <div class="subsection-row">
                  <div class="dropzone" data-id="A31"></div>
                </div>
                <div class="subsection-row">
                  <div class="dropzone" data-id="A32"></div>
                </div>
                <div class="subsection-row">
                  <div class="dropzone" data-id="A33"></div>
                </div>
              </div>
            </div>

            <!-- Secci√≥n A4 -->
            <div class="section-row">
              <div class="section-main">
                <div class="section-title">
                  <div class="dropzone" data-id="A4"></div>
                </div>
              </div>
              <div class="subsections">
                <div class="subsection-row">
                  <div class="dropzone" data-id="A41"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bloque B -->
        <div class="simple-block">
          <div class="simple-main">
            <div class="block-title">
              <div class="dropzone" data-id="B"></div>
            </div>
          </div>
          <div class="simple-content">
            <div class="simple-item">
              <div class="dropzone" data-id="B1"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="B2"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="B3"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="B4"></div>
            </div>
          </div>
        </div>

        <!-- Bloque C -->
        <div class="simple-block">
          <div class="simple-main">
            <div class="block-title">
              <div class="dropzone" data-id="C"></div>
            </div>
          </div>
          <div class="simple-content">
            <div class="simple-item">
              <div class="dropzone" data-id="C1"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="C2"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="C3"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="C4"></div>
            </div>
          </div>
        </div>

        <!-- Bloque D -->
        <div class="simple-block">
          <div class="simple-main">
            <div class="block-title">
              <div class="dropzone" data-id="D"></div>
            </div>
          </div>
          <div class="simple-content">
            <div class="simple-item">
              <div class="dropzone" data-id="D1"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="D2"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="D3"></div>
            </div>
            <div class="simple-item">
              <div class="dropzone" data-id="D4"></div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    const items = [
      // Principales
      {id: 'A', title: 'A', content: 'Proceso de resoluci√≥n de problemas.'},
      {id: 'B', title: 'B', content: 'Operadores tecnol√≥gicos.'},
      {id: 'C', title: 'C', content: 'Pensamiento computacional, automatizaci√≥n y rob√≥tica.'},
      {id: 'D', title: 'D', content: 'Tecnolog√≠a sostenible.'},
      // Secciones A
      {id: 'A1', title: 'A.1', content: 'Estrategias y t√©cnicas.'},
      {id: 'A2', title: 'A.2', content: 'Productos y materiales.'},
      {id: 'A3', title: 'A.3', content: 'Fabricaci√≥n.'},
      {id: 'A4', title: 'A.4', content: 'Difusi√≥n.'},
      // Subsecciones
      {id: 'A11', title: 'A.1.1', content: 'Estrategias de gesti√≥n de proyectos colaborativos y t√©cnicas de resoluci√≥n de problemas iterativas.'},
      {id: 'A12', title: 'A.1.2', content: 'Estudio de necesidades del centro, locales y de la Comunidad Aut√≥noma Andaluza. Planteamiento de proyectos colaborativos o cooperativos.'},
      {id: 'A13', title: 'A.1.3', content: 'T√©cnicas de ideaci√≥n.'},
      {id: 'A14', title: 'A.1.4', content: 'Emprendimiento, perseverancia y creatividad en la resoluci√≥n de problemas desde una perspectiva interdisciplinar de la actividad tecnol√≥gica y satisfacci√≥n e inter√©s por el trabajo y la calidad del mismo.'},
      {id: 'A21', title: 'A.2.1', content: 'Ciclo de vida de un producto y sus fases. An√°lisis sencillos.'},
      {id: 'A22', title: 'A.2.2', content: 'Estrategias de selecci√≥n de materiales en base a sus propiedades o requisitos.'},
      {id: 'A31', title: 'A.3.1', content: 'Herramientas de dise√±o asistido por computador en tres dimensiones en la representaci√≥n o fabricaci√≥n de piezas aplicadas a proyectos.'},
      {id: 'A32', title: 'A.3.2', content: 'T√©cnicas de fabricaci√≥n manual y mec√°nica. Aplicaciones pr√°cticas.'},
      {id: 'A33', title: 'A.3.3', content: 'T√©cnicas de fabricaci√≥n digital. Impresi√≥n en tres dimensiones y corte. Aplicaciones pr√°cticas.'},
      {id: 'A41', title: 'A.4.1', content: 'Presentaci√≥n y difusi√≥n del proyecto. Elementos, t√©cnicas y herramientas. Comunicaci√≥n efectiva de entonaci√≥n, expresi√≥n, gesti√≥n del tiempo, adaptaci√≥n del discurso y uso de un lenguaje inclusivo, libre de estereotipos sexistas.'},
      {id: 'B1', title: 'B.1', content: 'Electr√≥nica anal√≥gica. Componentes b√°sicos, simbolog√≠a, an√°lisis y montaje f√≠sico y simulado de circuitos elementales.'},
      {id: 'B2', title: 'B.2', content: 'Electr√≥nica digital b√°sica.'},
      {id: 'B3', title: 'B.3', content: 'Neum√°tica b√°sica. Circuitos.'},
      {id: 'B4', title: 'B.4', content: 'Elementos mec√°nicos, electr√≥nicos y neum√°ticos aplicados a la rob√≥tica. Montaje f√≠sico o simulado.'},
      {id: 'C1', title: 'C.1', content: 'Componentes de sistemas de control programado: controladores, sensores y actuadores.'},
      {id: 'C2', title: 'C.2', content: 'El ordenador y los dispositivos m√≥viles como elementos de programaci√≥n y control. Trabajo con simuladores inform√°ticos en la verificaci√≥n y comprobaci√≥n del funcionamiento de los sistemas dise√±ados. Iniciaci√≥n a las aplicaciones de inteligencia artificial y el big data. Espacios compartidos y discos virtuales.'},
      {id: 'C3', title: 'C.3', content: 'Telecomunicaciones en sistemas de control digital; elementos, comunicaciones y control del internet de las cosas. Aplicaciones pr√°cticas.'},
      {id: 'C4', title: 'C.4', content: 'Rob√≥tica. Dise√±o, construcci√≥n y control de robots sencillos de manera f√≠sica o simulada.'},
      {id: 'D1', title: 'D.1', content: 'Sostenibilidad y accesibilidad en la selecci√≥n de materiales y dise√±o de procesos, de productos y sistemas tecnol√≥gicos.'},
      {id: 'D2', title: 'D.2', content: 'Arquitectura bioclim√°tica y sostenible. Ahorro energ√©tico en edificios.'},
      {id: 'D3', title: 'D.3', content: 'Transporte y sostenibilidad.'},
      {id: 'D4', title: 'D.4', content: 'Comunidades abiertas, voluntariado tecnol√≥gico y proyectos de servicio a la comunidad.'}
    ];

    const keywordSchema = {
      'A': 'Proceso resoluci√≥n problemas',
      'A1': 'Estrategias y t√©cnicas', 
      'A11': 'Gesti√≥n proyectos t√©cnicas iterativas',
      'A12': 'Estudio necesidades centro Andaluc√≠a',
      'A13': 'T√©cnicas de ideaci√≥n',
      'A14': 'Emprendimiento perseverancia creatividad',
      'A2': 'Productos y materiales',
      'A21': 'Ciclo vida producto fases',
      'A22': 'Selecci√≥n materiales propiedades requisitos',
      'A3': 'Fabricaci√≥n',
      'A31': 'Herramientas dise√±o asistido computador',
      'A32': 'Fabricaci√≥n manual y mec√°nica',
      'A33': 'Fabricaci√≥n digital impresi√≥n 3D',
      'A4': 'Difusi√≥n',
      'A41': 'Presentaci√≥n difusi√≥n comunicaci√≥n efectiva',
      'B': 'Operadores tecnol√≥gicos',
      'B1': 'Electr√≥nica anal√≥gica componentes b√°sicos',
      'B2': 'Electr√≥nica digital b√°sica',
      'B3': 'Neum√°tica b√°sica circuitos',
      'B4': 'Elementos mec√°nicos electr√≥nicos rob√≥tica',
      'C': 'Pensamiento computacional automatizaci√≥n rob√≥tica',
      'C1': 'Componentes sistemas control programado',
      'C2': 'Ordenador dispositivos m√≥viles programaci√≥n',
      'C3': 'Telecomunicaciones sistemas control digital',
      'C4': 'Rob√≥tica dise√±o construcci√≥n control',
      'D': 'Tecnolog√≠a sostenible',
      'D1': 'Sostenibilidad accesibilidad selecci√≥n materiales',
      'D2': 'Arquitectura bioclim√°tica sostenible',
      'D3': 'Transporte y sostenibilidad',
      'D4': 'Comunidades abiertas voluntariado tecnol√≥gico'
    };

    let correctCount = 0;
    let selectedCard = null;
    let currentZoom = 1.0;
    let showingKeywords = false;

    function createCard(item) {
      const card = document.createElement('div');
      card.className = 'card';
      card.draggable = true;
      card.dataset.id = item.id;
      
      // Contenido sin el √≠ndice para no dar pistas
      const contentWithoutIndex = item.content;
      
      card.innerHTML = `
        <div class="card-inner">
          <div class="card-front">${contentWithoutIndex}</div>
          <div class="card-back">${item.title}</div>
        </div>
      `;

      // Click to flip
      card.addEventListener('click', (e) => {
        if (!card.classList.contains('dragging')) {
          card.classList.toggle('flipped');
          selectCard(card);
        }
      });

      // Drag events
      card.addEventListener('dragstart', (e) => {
        card.classList.add('dragging');
        e.dataTransfer.setData('text/plain', item.id);
        selectCard(card);
      });

      card.addEventListener('dragend', () => {
        card.classList.remove('dragging');
      });

      return card;
    }

    function selectCard(card) {
      if (selectedCard) {
        selectedCard.classList.remove('pulse');
      }
      selectedCard = card;
      card.classList.add('pulse');
    }

    function renderCards() {
      const container = document.getElementById('cardsGrid');
      container.innerHTML = '';
      
      const shuffled = [...items].sort(() => Math.random() - 0.5);
      shuffled.forEach(item => {
        container.appendChild(createCard(item));
      });
    }

    // Nueva funci√≥n de filtrado para el buscador
    function filterCards() {
      const searchTerm = document.getElementById('searchBox').value.toLowerCase();
      const cards = document.querySelectorAll('.card');
      
      cards.forEach(card => {
        const item = items.find(i => i.id === card.dataset.id);
        const searchText = `${item.title} ${item.content}`.toLowerCase();
        
        if (searchText.includes(searchTerm)) {
          card.classList.remove('hidden');
        } else {
          card.classList.add('hidden');
        }
      });
    }

    // Nueva funci√≥n de zoom
    function zoomSchema(zoomLevel) {
      currentZoom = zoomLevel;
      const container = document.getElementById('schemaContainer');
      container.style.transform = `scale(${zoomLevel})`;
    }

    // Nueva funci√≥n para mostrar esquema con palabras clave
    function toggleKeywordSchema() {
      showingKeywords = !showingKeywords;
      
      document.querySelectorAll('.dropzone').forEach(zone => {
        const zoneId = zone.dataset.id;
        if (showingKeywords) {
          const keyword = keywordSchema[zoneId] || zoneId;
          zone.innerHTML = `<div class="placed-card" style="background: linear-gradient(135deg, #9b59b6, #8e44ad); font-size: 11px;">${keyword}</div>`;
        } else {
          zone.innerHTML = '';
        }
      });

      // Cambiar texto del bot√≥n
      const button = event.target;
      button.textContent = showingKeywords ? 'üîÑ Ocultar Claves' : 'üóùÔ∏è Esquema Clave';
      
      // Ocultar/mostrar tarjetas
      const cardsGrid = document.getElementById('cardsGrid');
      cardsGrid.style.display = showingKeywords ? 'none' : 'grid';
      
      if (showingKeywords) {
        document.getElementById('correctCount').textContent = '30';
        document.getElementById('progressBar').style.width = '100%';
      } else {
        resetGame();
      }
    }

    function setupDropzones() {
      const dropzones = document.querySelectorAll('.dropzone');
      
      dropzones.forEach(zone => {
        zone.addEventListener('dragover', (e) => {
          e.preventDefault();
          zone.classList.add('drag-over');
        });

        zone.addEventListener('dragleave', () => {
          zone.classList.remove('drag-over');
        });

        zone.addEventListener('drop', (e) => {
          e.preventDefault();
          zone.classList.remove('drag-over');
          
          const itemId = e.dataTransfer.getData('text/plain');
          const correctId = zone.dataset.id;
          if (itemId === correctId) {
            const card = document.querySelector(`.card[data-id="${itemId}"]`);
            if (card) card.remove();

            zone.innerHTML = `<div class="placed-card">${items.find(i => i.id === itemId).content}</div>`;
            zone.classList.add('animate-correct');
            setTimeout(() => zone.classList.remove('animate-correct'), 600);

            correctCount++;
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('progressBar').style.width = `${(correctCount/items.length)*100}%`;
          } else {
            zone.classList.add('animate-wrong');
            setTimeout(() => zone.classList.remove('animate-wrong'), 600);
          }
        });
      });
    }

    function resetGame() {
      correctCount = 0;
      showingKeywords = false;
      document.getElementById('correctCount').textContent = 0;
      document.getElementById('progressBar').style.width = '0%';
      document.querySelectorAll('.dropzone').forEach(z => z.innerHTML = '');
      document.getElementById('searchBox').value = '';
      document.getElementById('cardsGrid').style.display = 'grid';
      
      // Restaurar texto del bot√≥n
      const buttons = document.querySelectorAll('button');
      buttons.forEach(btn => {
        if (btn.textContent.includes('Ocultar Claves')) {
          btn.textContent = 'üóùÔ∏è Esquema Clave';
        }
      });
      
      renderCards();
    }

    function studyMode() {
      resetGame();
      document.getElementById('cardsGrid').innerHTML = '';
      items.forEach(item => {
        document.querySelector(`.dropzone[data-id="${item.id}"]`).innerHTML = `<div class="placed-card">${item.content}</div>`;
      });
    }

    function shuffleCards() {
      if (!showingKeywords) {
        renderCards();
      }
    }

    // Inicializar
    renderCards();
    setupDropzones();
  </script>